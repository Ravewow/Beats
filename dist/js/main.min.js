"use strict";var player,hamburgerMenu=document.querySelector(".hamburger__menu"),closeMenu=document.querySelector(".humburger__header-icon"),headerHamburger=document.querySelector(".header__humburger-item"),slider=(headerHamburger.addEventListener("click",function(e){hamburgerMenu.classList.add("hamburger__visible")}),closeMenu.addEventListener("click",function(e){hamburgerMenu.classList.remove("hamburger__visible")}),headerHamburger.addEventListener("click",function(e){e.preventDefault()}),$(".slider__list").bxSlider({pager:!1,controls:!1})),openItem=($(".slider__arrow--right").click(function(e){slider.goToNextSlide()}),$(".slider__arrow--left").click(function(e){slider.goToPrevSlide()}),function(e){var e=e.closest(".team__item"),t=e.find(".portfolio__description"),n=t.find(".portfolio__description-block").height();e.addClass("active"),t.height(n)}),closeEveryItem=function(e){var t=e.find(".portfolio__description");e.find(".team__item").removeClass("active"),t.height(0)},findBlockByAlias=($(".portfolio__name").click(function(e){var e=$(e.currentTarget),t=e.closest(".team__list"),n=e.closest(".team__item");e.next(".portfolio__name-triangle").toggleClass("portfolio__name-triangle--rotate"),n.hasClass("active")?closeEveryItem(t):(closeEveryItem(t),openItem(e))}),function(n){return $(".reviews__display-inner").filter(function(e,t){return $(t).attr("data-linked-with")===n})}),validateFields=($(".interactive-avatar__link").click(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.attr("data-open"),t=findBlockByAlias(t),e=e.closest(".reviews__switcher-item");t.addClass("reviews__display-inner--active").siblings().removeClass("reviews__display-inner--active"),e.addClass("interactive-avatar--active").siblings().removeClass("interactive-avatar--active")}),function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""===e.val().trim()&&e.addClass("input-error")}),0===e.find(".input-error").length}),mesureWidth=($(".form").submit(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.find("[name='name']"),n=e.find("[name='phone']"),a=e.find("[name='comment']"),r=e.find("[name='to']");$(".swal-title").removeClass("error-modal"),validateFields(e,[t,n,a,r])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:t.val(),phone:n.val(),comment:a.val(),to:r.val()}})).done(function(e){swal({title:e.message,button:"Закрыть"}),$("body").addClass("body__frozen"),$(".swal-button").click(function(){$(".body").removeClass("body__frozen"),$("#form").trigger("reset")})}),e.fail(function(){swal({title:"Отправить письмо не удалось, повторите запрос позже",button:"Закрыть"}),$("body").addClass("body__frozen"),$(".swal-title").addClass("error-modal"),$(".swal-button").click(function(){$(".body").removeClass("body__frozen"),$("#form").trigger("reset")})}))}),function(e){var t=0,n=$(window).width(),a=e.closest(".products-menu").find(".products-menu__title"),a=a.width()*a.length,e=e.find(".products__menu-textcontent"),r=parseInt(e.css("padding-left")),e=parseInt(e.css("padding-right"));return{container:t=window.matchMedia("(max-width: 768px)").matches?n-a:500,textContainer:t-r-e}}),closeEveryItemInContainer=function(e){var t=e.find(".products-menu__item"),e=e.find(".products-menu__content");t.removeClass("products-menu__item--active"),e.width(0)},openItemAcco=function(e){var t=e.find(".products-menu__content"),n=mesureWidth(e),a=e.find(".products__menu-textcontent");e.addClass("products-menu__item--active"),t.width(n.container),a.width(n.textContainer)},playerContainer=($(".products-menu__title").on("click",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.closest(".products-menu__item"),n=t.hasClass("products-menu__item--active"),e=e.closest(".products-menu");n?closeEveryItemInContainer(e):(closeEveryItemInContainer(e),openItemAcco(t))}),$(".product-menu__close").on("click",function(e){e.preventDefault(),closeEveryItemInContainer($(".products-menu"))}),$(".player")),eventsInit=function(){$(".player__start").click(function(e){e.preventDefault(),playerContainer.hasClass("paused")?player.pauseVideo():player.playVideo()}),$(".player__playback").click(function(e){var t=$(e.currentTarget),e=e.originalEvent.layerX/t.width()*100,t=player.getDuration()/100*e;$(".player__playback-button").css({left:"".concat(e,"%")}),player.seekTo(t)}),$(".player__splash").click(function(e){player.playVideo()})},playVolume=$(".player__volume"),isMuted=!1,formatTime=($(".player__volume").click(function(e){e.preventDefault(),isMuted=isMuted?(player.mute(),!1):(player.unMute(),!0)}),$(".player__playback-volume").click(function(e){var t=$(e.currentTarget),e=e.originalEvent.layerX/t.width()*100;player.getVolume();$(".player__volume-button").css({left:"".concat(e,"%")}),player.setVolume(e)}),function(e){var e=Math.round(e),t=n(Math.floor(e/60)),e=n(e-60*t);function n(e){return e<10?"0".concat(e):e}return"".concat(t," : ").concat(e)}),onPlayerReady=function(){var n=player.getDuration();$(".player__duration-estimate").text(formatTime(n)),setInterval(function(){var e=player.getCurrentTime(),t=e/n*100;$(".player__playback-button").css({left:"".concat(t,"%")}),$(".player__duration-completed").text(formatTime(e))},1e3)},onPlayerStateChange=function(e){switch(e.data){case 0:playerContainer.removeClass("active"),playerContainer.removeClass("paused");break;case 1:playerContainer.addClass("active"),playerContainer.addClass("paused");break;case 2:playerContainer.removeClass("active"),playerContainer.removeClass("paused")}};function onYouTubeIframeAPIReady(){player=new YT.Player("yt-player",{height:"392",width:"662",videoId:"1_f3RcyYdfA",events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange},playerVars:{controls:0,disablekb:1,showinfo:0,rel:0,autoplay:0,modestbranding:0}})}eventsInit();var myMap,sections=$("section"),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1,countSectionPosition=(sections.first().addClass("active"),function(e){e*=-100;return isNaN(e)?(console.error("Передано не верное значение в countSectionPosition"),0):e}),changeMenuThemeForSection=function(e){var t="fixed-menu--white";"dark--white"===sections.eq(e).attr("data-sidemenu-theme")?sideMenu.addClass(t):sideMenu.removeClass(t)},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),sections.eq(e).addClass("active").siblings().removeClass("active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},1300))},viewporScroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}},init=($(window).on("wheel",function(e){var e=e.originalEvent.deltaY,t=viewporScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"===t||"textarea"===t,n=viewporScroller();if(!t)switch(e.keyCode){case 38:n("prev");break;case 40:n("next")}}),$(".wrapper").on("touchemove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewporScroller()["down"===t?"prev":"up"===t?"next":""]()}}),function(){myMap=new ymaps.Map("map",{center:[55.742262,37.598628],zoom:14.33,controls:[]});var t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/decor/pin_image.png",iconImageSize:[46,57],iconImageOffset:[-35,-52]});[[55.755575,37.582903],[55.739807,37.58304],[55.756734,37.624288],[55.750527,37.606578]].forEach(function(e){t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")});ymaps.ready(init);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJtYXAuanMiXSwibmFtZXMiOlsicGxheWVyIiwiaGFtYnVyZ2VyTWVudSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNsb3NlTWVudSIsImhlYWRlckhhbWJ1cmdlciIsInNsaWRlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwicHJldmVudERlZmF1bHQiLCIkIiwiYnhTbGlkZXIiLCJwYWdlciIsImNvbnRyb2xzIiwib3Blbkl0ZW0iLCJjbGljayIsImdvVG9OZXh0U2xpZGUiLCJnb1RvUHJldlNsaWRlIiwiaXRlbSIsImNvbnRhaW5lciIsImNsb3Nlc3QiLCJjb250ZW50QmxvY2siLCJmaW5kIiwicmVxSGVpZ2h0IiwiaGVpZ2h0IiwiYWRkQ2xhc3MiLCJjbG9zZUV2ZXJ5SXRlbSIsIml0ZW1zIiwicmVtb3ZlQ2xhc3MiLCJmaW5kQmxvY2tCeUFsaWFzIiwiJHRoaXMiLCJjdXJyZW50VGFyZ2V0IiwiZWxlbUNvbnRhaW5lciIsIm5leHQiLCJ0b2dnbGVDbGFzcyIsImhhc0NsYXNzIiwiYWxpYXMiLCJmaWx0ZXIiLCJuZHgiLCJhdHRyIiwidmFsaWRhdGVGaWVsZHMiLCJ0YXJnZXQiLCJpdGVtVG9TaG93IiwiY3VySXRlbSIsInNpYmxpbmdzIiwiZm9ybSIsImZpZWxkQXJyYXkiLCJmb3JFYWNoIiwiZmllbGQiLCJ2YWwiLCJ0cmltIiwibGVuZ3RoIiwibWVzdXJlV2lkdGgiLCJzdWJtaXQiLCJuYW1lIiwicGhvbmUiLCJjb21tZW50IiwidG8iLCJyZXF1ZXN0RGVsaXZlcnkiLCJhamF4IiwidXJsIiwibWV0aG9kIiwiZGF0YSIsImRvbmUiLCJzd2FsIiwidGl0bGUiLCJtZXNzYWdlIiwiYnV0dG9uIiwidHJpZ2dlciIsImZhaWwiLCJyZXFJdGVtV2l0aCIsInNjcmVlbldpZHRoIiwid2luZG93Iiwid2lkdGgiLCJ0aXRsZXNCbG9jayIsInRpdGxlc1dpZHRoIiwidGV4dENvbnRhaW5lciIsInBhZGRpbmdMZWZ0IiwicGFyc2VJbnQiLCJjc3MiLCJwYWRkaW5nUmlnaHQiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsImNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIiLCJjb250ZW50Iiwib3Blbkl0ZW1BY2NvIiwiaGlkZGVuQ29udGVudCIsInJlcVdpZHRoIiwidGV4dEJsb2NrIiwicGxheWVyQ29udGFpbmVyIiwib24iLCJpdGVtT3BlbmVkIiwiZXZlbnRzSW5pdCIsInBhdXNlVmlkZW8iLCJwbGF5VmlkZW8iLCJiYXIiLCJuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQiLCJvcmlnaW5hbEV2ZW50IiwibGF5ZXJYIiwibmV3UGxheWJhY2tQb3NpdGlvblNlYyIsImdldER1cmF0aW9uIiwibGVmdCIsImNvbmNhdCIsInNlZWtUbyIsInBsYXlWb2x1bWUiLCJpc011dGVkIiwiZm9ybWF0VGltZSIsIm11dGUiLCJ1bk11dGUiLCJiYXJWb2x1bWUiLCJuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnRWb2x1bWUiLCJnZXRWb2x1bWUiLCJzZXRWb2x1bWUiLCJ0aW1lU2VjIiwicm91bmRUaW1lIiwiTWF0aCIsInJvdW5kIiwibWludXRlcyIsImFkZFplcm8iLCJmbG9vciIsInNlY29uZHMiLCJudW0iLCJvblBsYXllclJlYWR5IiwiZHVyYXRpb25TZWMiLCJ0ZXh0Iiwic2V0SW50ZXJ2YWwiLCJjb21wbGV0ZWRTZWMiLCJnZXRDdXJyZW50VGltZSIsImNvbXBsZXRlZFBlcmNlbnQiLCJvblBsYXllclN0YXRlQ2hhbmdlIiwiZXZlbnQiLCJvbllvdVR1YmVJZnJhbWVBUElSZWFkeSIsIllUIiwiUGxheWVyIiwidmlkZW9JZCIsImV2ZW50cyIsIm9uUmVhZHkiLCJvblN0YXRlQ2hhbmdlIiwicGxheWVyVmFycyIsImRpc2FibGVrYiIsInNob3dpbmZvIiwicmVsIiwiYXV0b3BsYXkiLCJtb2Rlc3RicmFuZGluZyIsIm15TWFwIiwic2VjdGlvbnMiLCJkaXNwbGF5Iiwic2lkZU1lbnUiLCJtZW51SXRlbXMiLCJtb2JpbGVEZXRlY3QiLCJNb2JpbGVEZXRlY3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJpc01vYmlsZSIsIm1vYmlsZSIsImluU2Nyb2xsIiwiY291bnRTZWN0aW9uUG9zaXRpb24iLCJmaXJzdCIsInNlY3Rpb25FcSIsInBvc2l0aW9uIiwiaXNOYU4iLCJjb25zb2xlIiwiZXJyb3IiLCJjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uIiwiYWN0aXZlQ2xhc3MiLCJlcSIsInJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtIiwiaXRlbUVxIiwicGVyZm9ybVRyYW5zaXRpb24iLCJ0cmFuc2Zvcm0iLCJzZXRUaW1lb3V0IiwidHJhbnNpdGlvbk92ZXIiLCJ2aWV3cG9yU2Nyb2xsZXIiLCJhY3RpdmVTZWN0aW9uIiwibmV4dFNlY3Rpb24iLCJwcmV2U2VjdGlvbiIsInByZXYiLCJpbmRleCIsImluaXQiLCJkZWx0YVkiLCJzY3JvbGxlciIsInRhZ05hbWUiLCJ0b0xvd2VyQ2FzZSIsInVzZXJUeXBpbmdJbklucHV0cyIsImtleUNvZGUiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJkaXJlY3Rpb24iLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsInpvb20iLCJteUNvbGxlY3Rpb24iLCJHZW9PYmplY3RDb2xsZWN0aW9uIiwiZHJhZ2dhYmxlIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiY29vcmQiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYmVoYXZpb3JzIiwiZGlzYWJsZSIsInJlYWR5Il0sIm1hcHBpbmdzIjoiYUFFQSxJQTBOQUEsT0ExTkFDLGNBQUFDLFNBQUFDLGNBQUEsa0JBQUEsRUFDQUMsVUFBQUYsU0FBQUMsY0FBQSx5QkFBQSxFQUNBRSxnQkFBQUgsU0FBQUMsY0FBQSx5QkFBQSxFQWlCQUcsUUFmQUQsZ0JBQUFFLGlCQUFBLFFBQUEsU0FBQUMsR0FDQVAsY0FBQVEsVUFBQUMsSUFBQSxvQkFBQSxDQUNBLENBQUEs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LE1BQUEsQ0FBQSxDQUNBLENBQUEsRUFJQXhCLFVBR0EvSSxFQUFBLE1BQUEsRUFBQWdMLE1BQUEsQ0FDQUEsTUFBQSxTQUFBeEQsRUFBQXlELEdBQ0FmLGdCQUFBLEVBSUEsU0FBQWUsRUFBQSxPQURBLE9BQUFBLEVBQUEsT0FGQSxJQUtBLENBQ0EsQ0FDQSxDQUFBLEVDL2VBLFdBQ0EzQyxNQUFBLElBQUE0QyxNQUFBQyxJQUFBLE1BQUEsQ0FDQUMsT0FBQSxDQUFBLFVBQUEsV0FDQUMsS0FBQSxNQUNBbEwsU0FBQSxFQUNBLENBQUEsRUFFQSxJQU9BbUwsRUFBQSxJQUFBSixNQUFBSyxvQkFDQSxHQUNBLENBQ0FDLFVBQUEsQ0FBQSxFQUNBQyxXQUFBLGdCQUNBQyxjQUFBLDRCQUNBQyxjQUFBLENBQUEsR0FBQSxJQUNBQyxnQkFBQSxDQUFBLENBQUEsR0FBQSxDQUFBLEdBQ0EsQ0FBQSxFQWZBLENBQ0EsQ0FBQSxVQUFBLFdBQ0EsQ0FBQSxVQUFBLFVBQ0EsQ0FBQSxVQUFBLFdBQ0EsQ0FBQSxVQUFBLFlBY0F2SixRQUFBLFNBQUF3SixHQUNBUCxFQUFBekwsSUFBQSxJQUFBcUwsTUFBQVksVUFBQUQsQ0FBQSxDQUFBLENBQ0EsQ0FBQSxFQUNBdkQsTUFBQXlELFdBQUFsTSxJQUFBeUwsQ0FBQSxFQUNBaEQsTUFBQTBELFVBQUFDLFFBQUEsWUFBQSxDQUNBLEdBRUFmLE1BQUFnQixNQUFBMUIsSUFBQSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGhhbWJ1cmdlciBNZW51XG5cbmNvbnN0IGhhbWJ1cmdlck1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhhbWJ1cmdlcl9fbWVudVwiKTtcbmNvbnN0IGNsb3NlTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaHVtYnVyZ2VyX19oZWFkZXItaWNvblwiKTtcbmNvbnN0IGhlYWRlckhhbWJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19odW1idXJnZXItaXRlbVwiKTtcblxuaGVhZGVySGFtYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBoYW1idXJnZXJNZW51LmNsYXNzTGlzdC5hZGQoXCJoYW1idXJnZXJfX3Zpc2libGVcIik7XG59KTtcblxuY2xvc2VNZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBoYW1idXJnZXJNZW51LmNsYXNzTGlzdC5yZW1vdmUoXCJoYW1idXJnZXJfX3Zpc2libGVcIik7XG59KTtcblxuaGVhZGVySGFtYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG59KTtcblxuLy8gc2xpZGVyXG5cblxuY29uc3Qgc2xpZGVyID0gJChcIi5zbGlkZXJfX2xpc3RcIikuYnhTbGlkZXIoe1xuICBwYWdlcjogZmFsc2UsXG4gIGNvbnRyb2xzOiBmYWxzZSxcbn0pO1xuXG4kKFwiLnNsaWRlcl9fYXJyb3ctLXJpZ2h0XCIpLmNsaWNrKChlKSA9PiB7XG4gIHNsaWRlci5nb1RvTmV4dFNsaWRlKCk7XG59KTtcblxuJChcIi5zbGlkZXJfX2Fycm93LS1sZWZ0XCIpLmNsaWNrKChlKSA9PiB7XG4gIHNsaWRlci5nb1RvUHJldlNsaWRlKCk7XG59KTtcblxuLy8gdGVhbSBBbmltYXRpb25cbmNvbnN0IG9wZW5JdGVtID0gKGl0ZW0pID0+IHtcbiAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XG4gIGNvbnN0IGNvbnRlbnRCbG9jayA9IGNvbnRhaW5lci5maW5kKFwiLnBvcnRmb2xpb19fZGVzY3JpcHRpb25cIik7XG4gIGNvbnN0IHRleHRCbG9jayA9IGNvbnRlbnRCbG9jay5maW5kKFwiLnBvcnRmb2xpb19fZGVzY3JpcHRpb24tYmxvY2tcIik7XG4gIGNvbnN0IHJlcUhlaWdodCA9IHRleHRCbG9jay5oZWlnaHQoKTtcblxuICBjb250YWluZXIuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGNvbnRlbnRCbG9jay5oZWlnaHQocmVxSGVpZ2h0KTtcbn07XG5cbmNvbnN0IGNsb3NlRXZlcnlJdGVtID0gKGNvbnRhaW5lcikgPT4ge1xuICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnBvcnRmb2xpb19fZGVzY3JpcHRpb25cIik7XG4gIGNvbnN0IGl0ZW1Db250YWluZXIgPSBjb250YWluZXIuZmluZChcIi50ZWFtX19pdGVtXCIpO1xuXG4gIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gIGl0ZW1zLmhlaWdodCgwKTtcbn07XG5cbiQoXCIucG9ydGZvbGlvX19uYW1lXCIpLmNsaWNrKChlKSA9PiB7XG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1fX2xpc3RcIik7XG4gIGNvbnN0IGVsZW1Db250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XG4gIGNvbnN0IHRyaWFuZ2xlID0gJHRoaXMubmV4dChcIi5wb3J0Zm9saW9fX25hbWUtdHJpYW5nbGVcIik7XG5cbiAgdHJpYW5nbGUudG9nZ2xlQ2xhc3MoXCJwb3J0Zm9saW9fX25hbWUtdHJpYW5nbGUtLXJvdGF0ZVwiKTtcbiAgaWYgKGVsZW1Db250YWluZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcbiAgICBjbG9zZUV2ZXJ5SXRlbShjb250YWluZXIpO1xuICB9IGVsc2Uge1xuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XG4gICAgb3Blbkl0ZW0oJHRoaXMpO1xuICB9XG59KTtcblxuLy8gcmV2aWV3IEFuaW1hdGlvblxuXG5jb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gKGFsaWFzKSA9PiB7XG4gIHJldHVybiAkKFwiLnJldmlld3NfX2Rpc3BsYXktaW5uZXJcIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcbiAgICByZXR1cm4gJChpdGVtKS5hdHRyKFwiZGF0YS1saW5rZWQtd2l0aFwiKSA9PT0gYWxpYXM7XG4gIH0pO1xufTtcbiQoXCIuaW50ZXJhY3RpdmUtYXZhdGFyX19saW5rXCIpLmNsaWNrKChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cihcImRhdGEtb3BlblwiKTtcbiAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcbiAgY29uc3QgY3VySXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucmV2aWV3c19fc3dpdGNoZXItaXRlbVwiKTtcbiAgaXRlbVRvU2hvd1xuICAgIC5hZGRDbGFzcyhcInJldmlld3NfX2Rpc3BsYXktaW5uZXItLWFjdGl2ZVwiKVxuICAgIC5zaWJsaW5ncygpXG4gICAgLnJlbW92ZUNsYXNzKFwicmV2aWV3c19fZGlzcGxheS1pbm5lci0tYWN0aXZlXCIpO1xuICBjdXJJdGVtXG4gICAgLmFkZENsYXNzKFwiaW50ZXJhY3RpdmUtYXZhdGFyLS1hY3RpdmVcIilcbiAgICAuc2libGluZ3MoKVxuICAgIC5yZW1vdmVDbGFzcyhcImludGVyYWN0aXZlLWF2YXRhci0tYWN0aXZlXCIpO1xufSk7XG5cbi8vIGZvcm0gc2VjdGlvblxuLy8gLS1mb3JtXG5cbmNvbnN0IHZhbGlkYXRlRmllbGRzID0gKGZvcm0sIGZpZWxkQXJyYXkpID0+IHtcbiAgZmllbGRBcnJheS5mb3JFYWNoKChmaWVsZCkgPT4ge1xuICAgIGZpZWxkLnJlbW92ZUNsYXNzKFwiaW5wdXQtZXJyb3JcIik7XG4gICAgaWYgKGZpZWxkLnZhbCgpLnRyaW0oKSA9PT0gXCJcIikge1xuICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiLmlucHV0LWVycm9yXCIpO1xuICByZXR1cm4gZXJyb3JGaWVsZHMubGVuZ3RoID09PSAwO1xufTtcblxuJChcIi5mb3JtXCIpLnN1Ym1pdCgoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGZvcm0gPSAkKGUuY3VycmVudFRhcmdldCk7XG4gIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpO1xuICBjb25zdCBwaG9uZSA9IGZvcm0uZmluZChcIltuYW1lPSdwaG9uZSddXCIpO1xuICBjb25zdCBjb21tZW50ID0gZm9ybS5maW5kKFwiW25hbWU9J2NvbW1lbnQnXVwiKTtcbiAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcblxuICAkKFwiLnN3YWwtdGl0bGVcIikucmVtb3ZlQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcblxuICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdGVGaWVsZHMoZm9ybSwgW25hbWUsIHBob25lLCBjb21tZW50LCB0b10pO1xuXG4gIGlmIChpc1ZhbGlkKSB7XG4gICAgY29uc3QgcmVxdWVzdERlbGl2ZXJ5ID0gJC5hamF4KHtcbiAgICAgIHVybDogXCJodHRwczovL3dlYmRldi1hcGkubG9mdHNjaG9vbC5jb20vc2VuZG1haWxcIixcbiAgICAgIG1ldGhvZDogXCJwb3N0XCIsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIG5hbWU6IG5hbWUudmFsKCksXG4gICAgICAgIHBob25lOiBwaG9uZS52YWwoKSxcbiAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcbiAgICAgICAgdG86IHRvLnZhbCgpLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJlcXVlc3REZWxpdmVyeS5kb25lKChkYXRhKSA9PiB7XG4gICAgICBzd2FsKHtcbiAgICAgICAgdGl0bGU6IGRhdGEubWVzc2FnZSxcbiAgICAgICAgYnV0dG9uOiBcItCX0LDQutGA0YvRgtGMXCIsXG4gICAgICB9KTtcbiAgICAgICQoXCJib2R5XCIpLmFkZENsYXNzKFwiYm9keV9fZnJvemVuXCIpO1xuICAgICAgJChcIi5zd2FsLWJ1dHRvblwiKS5jbGljaygoKSA9PiB7XG4gICAgICAgICQoXCIuYm9keVwiKS5yZW1vdmVDbGFzcyhcImJvZHlfX2Zyb3plblwiKTtcbiAgICAgICAgJChcIiNmb3JtXCIpLnRyaWdnZXIoXCJyZXNldFwiKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmVxdWVzdERlbGl2ZXJ5LmZhaWwoKCkgPT4ge1xuICAgICAgc3dhbCh7XG4gICAgICAgIHRpdGxlOiBcItCe0YLQv9GA0LDQstC40YLRjCDQv9C40YHRjNC80L4g0L3QtSDRg9C00LDQu9C+0YHRjCwg0L/QvtCy0YLQvtGA0LjRgtC1INC30LDQv9GA0L7RgSDQv9C+0LfQttC1XCIsXG4gICAgICAgIGJ1dHRvbjogXCLQl9Cw0LrRgNGL0YLRjFwiLFxuICAgICAgfSk7XG4gICAgICAkKFwiYm9keVwiKS5hZGRDbGFzcyhcImJvZHlfX2Zyb3plblwiKTtcbiAgICAgICQoXCIuc3dhbC10aXRsZVwiKS5hZGRDbGFzcyhcImVycm9yLW1vZGFsXCIpO1xuICAgICAgJChcIi5zd2FsLWJ1dHRvblwiKS5jbGljaygoKSA9PiB7XG4gICAgICAgICQoXCIuYm9keVwiKS5yZW1vdmVDbGFzcyhcImJvZHlfX2Zyb3plblwiKTtcbiAgICAgICAgJChcIiNmb3JtXCIpLnRyaWdnZXIoXCJyZXNldFwiKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59KTtcblxuLy8gcHJvZHVjdCBzZWN0aW9uXG5jb25zdCBtZXN1cmVXaWR0aCA9IChpdGVtKSA9PiB7XG4gIGxldCByZXFJdGVtV2l0aCA9IDA7XG4gIGNvbnN0IHNjcmVlbldpZHRoID0gJCh3aW5kb3cpLndpZHRoKCk7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdChcIi5wcm9kdWN0cy1tZW51XCIpO1xuICBjb25zdCB0aXRsZXNCbG9jayA9IGNvbnRhaW5lci5maW5kKFwiLnByb2R1Y3RzLW1lbnVfX3RpdGxlXCIpO1xuICBjb25zdCB0aXRsZXNXaWR0aCA9IHRpdGxlc0Jsb2NrLndpZHRoKCkgKiB0aXRsZXNCbG9jay5sZW5ndGg7XG4gIGNvbnN0IHRleHRDb250YWluZXIgPSBpdGVtLmZpbmQoXCIucHJvZHVjdHNfX21lbnUtdGV4dGNvbnRlbnRcIik7XG4gIGNvbnN0IHBhZGRpbmdMZWZ0ID0gcGFyc2VJbnQodGV4dENvbnRhaW5lci5jc3MoXCJwYWRkaW5nLWxlZnRcIikpO1xuICBjb25zdCBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctcmlnaHRcIikpO1xuICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XG5cbiAgaWYgKGlzTW9iaWxlKSB7XG4gICAgcmVxSXRlbVdpdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc1dpZHRoO1xuICB9IGVsc2Uge1xuICAgIHJlcUl0ZW1XaXRoID0gNTAwO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBjb250YWluZXI6IHJlcUl0ZW1XaXRoLFxuICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaXRoIC0gcGFkZGluZ0xlZnQgLSBwYWRkaW5nUmlnaHQsXG4gIH07XG59O1xuY29uc3QgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciA9IChjb250YWluZXIpID0+IHtcbiAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZChcIi5wcm9kdWN0cy1tZW51X19pdGVtXCIpO1xuICBjb25zdCBjb250ZW50ID0gY29udGFpbmVyLmZpbmQoXCIucHJvZHVjdHMtbWVudV9fY29udGVudFwiKTtcbiAgaXRlbXMucmVtb3ZlQ2xhc3MoXCJwcm9kdWN0cy1tZW51X19pdGVtLS1hY3RpdmVcIik7XG4gIGNvbnRlbnQud2lkdGgoMCk7XG59O1xuY29uc3Qgb3Blbkl0ZW1BY2NvID0gKGl0ZW0pID0+IHtcbiAgY29uc3QgaGlkZGVuQ29udGVudCA9IGl0ZW0uZmluZChcIi5wcm9kdWN0cy1tZW51X19jb250ZW50XCIpO1xuICBjb25zdCByZXFXaWR0aCA9IG1lc3VyZVdpZHRoKGl0ZW0pO1xuICBjb25zdCB0ZXh0QmxvY2sgPSBpdGVtLmZpbmQoXCIucHJvZHVjdHNfX21lbnUtdGV4dGNvbnRlbnRcIik7XG5cbiAgaXRlbS5hZGRDbGFzcyhcInByb2R1Y3RzLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKTtcbiAgaGlkZGVuQ29udGVudC53aWR0aChyZXFXaWR0aC5jb250YWluZXIpO1xuICB0ZXh0QmxvY2sud2lkdGgocmVxV2lkdGgudGV4dENvbnRhaW5lcik7XG59O1xuJChcIi5wcm9kdWN0cy1tZW51X190aXRsZVwiKS5vbihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgaXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucHJvZHVjdHMtbWVudV9faXRlbVwiKTtcbiAgY29uc3QgaXRlbU9wZW5lZCA9IGl0ZW0uaGFzQ2xhc3MoXCJwcm9kdWN0cy1tZW51X19pdGVtLS1hY3RpdmVcIik7XG4gIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIucHJvZHVjdHMtbWVudVwiKTtcblxuICBpZiAoaXRlbU9wZW5lZCkge1xuICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoY29udGFpbmVyKTtcbiAgfSBlbHNlIHtcbiAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKGNvbnRhaW5lcik7XG4gICAgb3Blbkl0ZW1BY2NvKGl0ZW0pO1xuICB9XG59KTtcblxuJChcIi5wcm9kdWN0LW1lbnVfX2Nsb3NlXCIpLm9uKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoJChcIi5wcm9kdWN0cy1tZW51XCIpKTtcbn0pO1xuXG4vLyBwbGF5ZXJcblxubGV0IHBsYXllcjtcbmNvbnN0IHBsYXllckNvbnRhaW5lciA9ICQoXCIucGxheWVyXCIpO1xuXG5sZXQgZXZlbnRzSW5pdCA9ICgpID0+IHtcbiAgJChcIi5wbGF5ZXJfX3N0YXJ0XCIpLmNsaWNrKChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgaWYgKHBsYXllckNvbnRhaW5lci5oYXNDbGFzcyhcInBhdXNlZFwiKSkge1xuICAgICAgcGxheWVyLnBhdXNlVmlkZW8oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGxheWVyLnBsYXlWaWRlbygpO1xuICAgIH1cbiAgfSk7XG5cbiAgJChcIi5wbGF5ZXJfX3BsYXliYWNrXCIpLmNsaWNrKChlKSA9PiB7XG4gICAgY29uc3QgYmFyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IGNsaWNrZWRQb3NpdGlvbiA9IGUub3JpZ2luYWxFdmVudC5sYXllclg7XG5cbiAgICBjb25zdCBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQgPSAoY2xpY2tlZFBvc2l0aW9uIC8gYmFyLndpZHRoKCkpICogMTAwO1xuICAgIGNvbnN0IG5ld1BsYXliYWNrUG9zaXRpb25TZWMgPVxuICAgICAgKHBsYXllci5nZXREdXJhdGlvbigpIC8gMTAwKSAqIG5ld0J1dHRvblBvc2l0aW9uUGVyY2VudDtcblxuICAgICQoXCIucGxheWVyX19wbGF5YmFjay1idXR0b25cIikuY3NzKHtcbiAgICAgIGxlZnQ6IGAke25ld0J1dHRvblBvc2l0aW9uUGVyY2VudH0lYCxcbiAgICB9KTtcblxuICAgIHBsYXllci5zZWVrVG8obmV3UGxheWJhY2tQb3NpdGlvblNlYyk7XG4gIH0pO1xuXG4gICQoXCIucGxheWVyX19zcGxhc2hcIikuY2xpY2soKGUpID0+IHtcbiAgICBwbGF5ZXIucGxheVZpZGVvKCk7XG4gIH0pO1xufTtcblxuY29uc3QgcGxheVZvbHVtZSA9ICQoXCIucGxheWVyX192b2x1bWVcIik7XG5sZXQgaXNNdXRlZCA9IGZhbHNlO1xuXG4kKFwiLnBsYXllcl9fdm9sdW1lXCIpLmNsaWNrKChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBpZiAoIWlzTXV0ZWQpIHtcbiAgICBwbGF5ZXIudW5NdXRlKCk7XG4gICAgaXNNdXRlZCA9IHRydWU7XG4gIH0gZWxzZSB7XG4gICAgcGxheWVyLm11dGUoKTtcbiAgICBpc011dGVkID0gZmFsc2U7XG4gIH1cbn0pO1xuXG4kKFwiLnBsYXllcl9fcGxheWJhY2stdm9sdW1lXCIpLmNsaWNrKChlKSA9PiB7XG4gIGNvbnN0IGJhclZvbHVtZSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgY29uc3QgY2xpY2tlZFBvc2l0aW9uVm9sdW1lID0gZS5vcmlnaW5hbEV2ZW50LmxheWVyWDtcblxuICBjb25zdCBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnRWb2x1bWUgPVxuICAgIChjbGlja2VkUG9zaXRpb25Wb2x1bWUgLyBiYXJWb2x1bWUud2lkdGgoKSkgKiAxMDA7XG4gIGNvbnN0IG5ld1BsYXliYWNrUG9zaXRpb25TZWNWb2x1bWUgPVxuICAgIChwbGF5ZXIuZ2V0Vm9sdW1lKCkgLyAxMDApICogbmV3QnV0dG9uUG9zaXRpb25QZXJjZW50Vm9sdW1lO1xuXG4gICQoXCIucGxheWVyX192b2x1bWUtYnV0dG9uXCIpLmNzcyh7XG4gICAgbGVmdDogYCR7bmV3QnV0dG9uUG9zaXRpb25QZXJjZW50Vm9sdW1lfSVgLFxuICB9KTtcblxuICBwbGF5ZXIuc2V0Vm9sdW1lKG5ld0J1dHRvblBvc2l0aW9uUGVyY2VudFZvbHVtZSk7XG59KTtcblxuY29uc3QgZm9ybWF0VGltZSA9ICh0aW1lU2VjKSA9PiB7XG4gIGNvbnN0IHJvdW5kVGltZSA9IE1hdGgucm91bmQodGltZVNlYyk7XG5cbiAgY29uc3QgbWludXRlcyA9IGFkZFplcm8oTWF0aC5mbG9vcihyb3VuZFRpbWUgLyA2MCkpO1xuICBjb25zdCBzZWNvbmRzID0gYWRkWmVybyhyb3VuZFRpbWUgLSBtaW51dGVzICogNjApO1xuXG4gIGZ1bmN0aW9uIGFkZFplcm8obnVtKSB7XG4gICAgcmV0dXJuIG51bSA8IDEwID8gYDAke251bX1gIDogbnVtO1xuICB9XG5cbiAgcmV0dXJuIGAke21pbnV0ZXN9IDogJHtzZWNvbmRzfWA7XG59O1xuXG5jb25zdCBvblBsYXllclJlYWR5ID0gKCkgPT4ge1xuICBsZXQgaW50ZXJ2YWw7XG4gIGNvbnN0IGR1cmF0aW9uU2VjID0gcGxheWVyLmdldER1cmF0aW9uKCk7XG5cbiAgJChcIi5wbGF5ZXJfX2R1cmF0aW9uLWVzdGltYXRlXCIpLnRleHQoZm9ybWF0VGltZShkdXJhdGlvblNlYykpO1xuXG4gIGlmICh0eXBlb2YgaW50ZXJ2YWwgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcbiAgfVxuXG4gIGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgIGNvbnN0IGNvbXBsZXRlZFNlYyA9IHBsYXllci5nZXRDdXJyZW50VGltZSgpO1xuICAgIGNvbnN0IGNvbXBsZXRlZFBlcmNlbnQgPSAoY29tcGxldGVkU2VjIC8gZHVyYXRpb25TZWMpICogMTAwO1xuXG4gICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWJ1dHRvblwiKS5jc3Moe1xuICAgICAgbGVmdDogYCR7Y29tcGxldGVkUGVyY2VudH0lYCxcbiAgICB9KTtcblxuICAgICQoXCIucGxheWVyX19kdXJhdGlvbi1jb21wbGV0ZWRcIikudGV4dChmb3JtYXRUaW1lKGNvbXBsZXRlZFNlYykpO1xuICB9LCAxMDAwKTtcbn07XG5cbmNvbnN0IG9uUGxheWVyU3RhdGVDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgLypcbiAgICAtMSAo0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNC1INCy0LjQtNC10L4g0L3QtSDQvdCw0YfQsNGC0L4pXG4gICAgMCAo0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNC1INCy0LjQtNC10L4g0LfQsNCy0LXRgNGI0LXQvdC+KVxuICAgIDEgKNCy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjQtSlcbiAgICAyICjQv9Cw0YPQt9CwKVxuICAgIDMgKNCx0YPRhNC10YDQuNC30LDRhtC40Y8pXG4gICAgNSAo0LLQuNC00LXQviDQv9C+0LTQsNGO0YIg0YDQtdC/0LvQuNC60LgpLlxuICAqL1xuICBzd2l0Y2ggKGV2ZW50LmRhdGEpIHtcbiAgICBjYXNlIDA6XG4gICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJwYXVzZWRcIik7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDE6XG4gICAgICBwbGF5ZXJDb250YWluZXIuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgICBwbGF5ZXJDb250YWluZXIuYWRkQ2xhc3MoXCJwYXVzZWRcIik7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgMjpcbiAgICAgIHBsYXllckNvbnRhaW5lci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgICAgIHBsYXllckNvbnRhaW5lci5yZW1vdmVDbGFzcyhcInBhdXNlZFwiKTtcbiAgICAgIGJyZWFrO1xuICB9XG59O1xuXG5mdW5jdGlvbiBvbllvdVR1YmVJZnJhbWVBUElSZWFkeSgpIHtcbiAgcGxheWVyID0gbmV3IFlULlBsYXllcihcInl0LXBsYXllclwiLCB7XG4gICAgaGVpZ2h0OiBcIjM5MlwiLFxuICAgIHdpZHRoOiBcIjY2MlwiLFxuICAgIHZpZGVvSWQ6IFwiMV9mM1JjeVlkZkFcIixcbiAgICBldmVudHM6IHtcbiAgICAgIG9uUmVhZHk6IG9uUGxheWVyUmVhZHksXG4gICAgICBvblN0YXRlQ2hhbmdlOiBvblBsYXllclN0YXRlQ2hhbmdlLFxuICAgIH0sXG4gICAgcGxheWVyVmFyczoge1xuICAgICAgY29udHJvbHM6IDAsXG4gICAgICBkaXNhYmxla2I6IDEsXG4gICAgICBzaG93aW5mbzogMCxcbiAgICAgIHJlbDogMCxcbiAgICAgIGF1dG9wbGF5OiAwLFxuICAgICAgbW9kZXN0YnJhbmRpbmc6IDAsXG4gICAgfSxcbiAgfSk7XG59XG5cbmV2ZW50c0luaXQoKTtcblxuLy8gZml4ZWQgbWVudVxuXG5jb25zdCBzZWN0aW9ucyA9ICQoXCJzZWN0aW9uXCIpO1xuY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbmNvbnRlbnRcIik7XG5jb25zdCBzaWRlTWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcbmNvbnN0IG1lbnVJdGVtcyA9IHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKTtcblxuY29uc3QgbW9iaWxlRGV0ZWN0ID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG5jb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcblxubGV0IGluU2Nyb2xsID0gZmFsc2U7XG5cbnNlY3Rpb25zLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG5cbmNvbnN0IGNvdW50U2VjdGlvblBvc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xuICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XG5cbiAgaWYgKGlzTmFOKHBvc2l0aW9uKSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLQn9C10YDQtdC00LDQvdC+INC90LUg0LLQtdGA0L3QvtC1INC30L3QsNGH0LXQvdC40LUg0LIgY291bnRTZWN0aW9uUG9zaXRpb25cIik7XG4gICAgcmV0dXJuIDA7XG4gIH1cbiAgcmV0dXJuIHBvc2l0aW9uO1xufTtcblxuY29uc3QgY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcbiAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9ucy5lcShzZWN0aW9uRXEpO1xuICBjb25zdCBtZW51VGhlbWUgPSBjdXJyZW50U2VjdGlvbi5hdHRyKFwiZGF0YS1zaWRlbWVudS10aGVtZVwiKTtcbiAgY29uc3QgYWN0aXZlQ2xhc3MgPSBcImZpeGVkLW1lbnUtLXdoaXRlXCI7XG5cbiAgaWYgKG1lbnVUaGVtZSA9PT0gXCJkYXJrLS13aGl0ZVwiKSB7XG4gICAgc2lkZU1lbnUuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpO1xuICB9IGVsc2Uge1xuICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcbiAgfVxufTtcblxuY29uc3QgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0gPSAoaXRlbXMsIGl0ZW1FcSwgYWN0aXZlQ2xhc3MpID0+IHtcbiAgaXRlbXMuZXEoaXRlbUVxKS5hZGRDbGFzcyhhY3RpdmVDbGFzcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhhY3RpdmVDbGFzcyk7XG59O1xuXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcbiAgaWYgKGluU2Nyb2xsKSByZXR1cm47XG5cbiAgY29uc3QgdHJhbnNpdGlvbk92ZXIgPSAxMDAwO1xuICBjb25zdCBtb3VzZUluZXJ0aWFPdmVyID0gMzAwO1xuXG4gIGluU2Nyb2xsID0gdHJ1ZTtcbiAgY29uc3QgcG9zaXRpb24gPSBjb3VudFNlY3Rpb25Qb3NpdGlvbihzZWN0aW9uRXEpO1xuXG4gIGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcblxuICBkaXNwbGF5LmNzcyh7XG4gICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSUpYCxcbiAgfSk7XG4gIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKHNlY3Rpb25zLCBzZWN0aW9uRXEsIFwiYWN0aXZlXCIpO1xuICBzZWN0aW9ucy5lcShzZWN0aW9uRXEpLmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG5cbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgaW5TY3JvbGwgPSBmYWxzZTtcbiAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XG4gIH0sIHRyYW5zaXRpb25PdmVyICsgbW91c2VJbmVydGlhT3Zlcik7XG59O1xuXG5jb25zdCB2aWV3cG9yU2Nyb2xsZXIgPSAoKSA9PiB7XG4gIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoXCIuYWN0aXZlXCIpO1xuICBjb25zdCBuZXh0U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ubmV4dCgpO1xuICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xuXG4gIHJldHVybiB7XG4gICAgbmV4dCgpIHtcbiAgICAgIGlmIChuZXh0U2VjdGlvbi5sZW5ndGgpIHtcbiAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24obmV4dFNlY3Rpb24uaW5kZXgoKSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBwcmV2KCkge1xuICAgICAgaWYgKHByZXZTZWN0aW9uLmxlbmd0aCkge1xuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcbiAgICAgIH1cbiAgICB9LFxuICB9O1xufTtcblxuJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgKGUpID0+IHtcbiAgY29uc3QgZGVsdGFZID0gZS5vcmlnaW5hbEV2ZW50LmRlbHRhWTtcbiAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9yU2Nyb2xsZXIoKTtcbiAgaWYgKGRlbHRhWSA+IDApIHtcbiAgICBzY3JvbGxlci5uZXh0KCk7XG4gIH1cblxuICBpZiAoZGVsdGFZIDwgMCkge1xuICAgIHNjcm9sbGVyLnByZXYoKTtcbiAgfVxufSk7XG5cbiQod2luZG93KS5vbihcImtleWRvd25cIiwgKGUpID0+IHtcbiAgY29uc3QgdGFnTmFtZSA9IGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgdXNlclR5cGluZ0luSW5wdXRzID0gdGFnTmFtZSA9PT0gXCJpbnB1dFwiIHx8IHRhZ05hbWUgPT09IFwidGV4dGFyZWFcIjtcbiAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9yU2Nyb2xsZXIoKTtcbiAgaWYgKHVzZXJUeXBpbmdJbklucHV0cykgcmV0dXJuO1xuXG4gIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgY2FzZSAzODpcbiAgICAgIHNjcm9sbGVyKFwicHJldlwiKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSA0MDpcbiAgICAgIHNjcm9sbGVyKFwibmV4dFwiKTtcbiAgICAgIGJyZWFrO1xuICB9XG59KTtcblxuJChcIi53cmFwcGVyXCIpLm9uKFwidG91Y2hlbW92ZVwiLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcblxuJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XG4gIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkPSR7dGFyZ2V0fV1gKTtcblxuICBwZXJmb3JtVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xufSk7XG5cbi8vIHRvdWNoIHN3aXBlXG5cbmlmIChpc01vYmlsZSkge1xuICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWF0dGJyeXNvbi9Ub3VjaFN3aXBlLUpxdWVyeS1QbHVnaW5cblxuICAkKFwiYm9keVwiKS5zd2lwZSh7XG4gICAgc3dpcGU6IGZ1bmN0aW9uIChldmVudCwgZGlyZWN0aW9uKSB7XG4gICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3JTY3JvbGxlcigpO1xuICAgICAgbGV0IHNjcm9sbERpcmVjdGlvbiA9IFwiXCI7XG5cbiAgICAgIGlmIChkaXJlY3Rpb24gPT09IFwidXBcIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJuZXh0XCI7XG4gICAgICBpZiAoZGlyZWN0aW9uID09PSBcImRvd25cIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJwcmV2XCI7XG5cbiAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjdGlvbl0oKTtcbiAgICB9LFxuICB9KTtcbn1cbiIsIi8vIHltYXBzLnJlYWR5KGluaXQpO1xuLy8gZnVuY3Rpb24gaW5pdCgpe1xuLy8gICAgIHZhciBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xuLy8gICAgICAgICBjZW50ZXI6IFs1NS43NDIyNjIsIDM3LjU5ODYyOF0sXG4vLyAgICAgICAgIHpvb206IDE0LjMzLFxuLy8gICAgICAgICBjb250cm9sczogW11cbi8vICAgICB9KTtcbi8vIH1cblxubGV0IG15TWFwO1xuXG5jb25zdCBpbml0ID0gKCkgPT4ge1xuICBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xuICAgIGNlbnRlcjogWzU1Ljc0MjI2MiwgMzcuNTk4NjI4XSxcbiAgICB6b29tOiAxNC4zMyxcbiAgICBjb250cm9sczogW10sXG4gIH0pO1xuXG4gIGNvbnN0IGNvb3JkcyA9IFtcbiAgICBbNTUuNzU1NTc1LCAzNy41ODI5MDNdLFxuICAgIFs1NS43Mzk4MDcsIDM3LjU4MzA0XSxcbiAgICBbNTUuNzU2NzM0LCAzNy42MjQyODhdLFxuICAgIFs1NS43NTA1MjcsIDM3LjYwNjU3OF0sXG4gIF07XG5cbiAgY29uc3QgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oXG4gICAge30sXG4gICAge1xuICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcbiAgICAgIGljb25MYXlvdXQ6IFwiZGVmYXVsdCNpbWFnZVwiLFxuICAgICAgaWNvbkltYWdlSHJlZjogXCIuL2ltZy9kZWNvci9waW5faW1hZ2UucG5nXCIsXG4gICAgICBpY29uSW1hZ2VTaXplOiBbNDYsIDU3XSxcbiAgICAgIGljb25JbWFnZU9mZnNldDogWy0zNSwgLTUyXSxcbiAgICB9XG4gICk7XG5cbiAgY29vcmRzLmZvckVhY2goKGNvb3JkKSA9PiB7XG4gICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrKGNvb3JkKSk7XG4gIH0pO1xuICBteU1hcC5nZW9PYmplY3RzLmFkZChteUNvbGxlY3Rpb24pO1xuICBteU1hcC5iZWhhdmlvcnMuZGlzYWJsZShcInNjcm9sbFpvb21cIik7XG59O1xuXG55bWFwcy5yZWFkeShpbml0KTtcbiJdfQ==
